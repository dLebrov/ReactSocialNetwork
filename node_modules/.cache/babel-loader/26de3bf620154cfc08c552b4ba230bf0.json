{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\\\u0414\\u043C\\u0438\\u0442\\u0440\\u0438\\u0439\\\\Desktop\\\\\\u0441\\u0430\\u0439\\u0442 4\\\\ReactSocialNetwork\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\\\u0414\\u043C\\u0438\\u0442\\u0440\\u0438\\u0439\\\\Desktop\\\\\\u0441\\u0430\\u0439\\u0442 4\\\\ReactSocialNetwork\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"C:\\\\Users\\\\\\u0414\\u043C\\u0438\\u0442\\u0440\\u0438\\u0439\\\\Desktop\\\\\\u0441\\u0430\\u0439\\u0442 4\\\\ReactSocialNetwork\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/objectSpread2\";import React from'react';import{authAPI}from\"../api/api\";import{stopSubmit}from\"redux-form\";var SET_USER_DATA='SET_USER_DATA';var SET_IS_FETCHING='TOGGLE_IS_FETCHING';var usersState={userId:null,email:null,login:null,isFetching:false,isAuth:false};var authReducer=function authReducer(){var state=arguments.length>0&&arguments[0]!==undefined?arguments[0]:usersState;var action=arguments.length>1?arguments[1]:undefined;switch(action.type){case SET_USER_DATA:return _objectSpread({},state,{},action.payload);case SET_IS_FETCHING:return _objectSpread({},state,{isFetching:action.isFetching});default:return state;}};export var setAuthUserData=function setAuthUserData(userId,email,login,isAuth){return{type:SET_USER_DATA,payload:{userId:userId,email:email,login:login,isAuth:isAuth}};};export var getAuthUserData=function getAuthUserData(){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(dispatch){var response,_response$data$data,id,email,_login;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return authAPI.me();case 2:response=_context.sent;if(response.data.resultCode===0){_response$data$data=response.data.data,id=_response$data$data.id,email=_response$data$data.email,_login=_response$data$data.login;dispatch(setAuthUserData(id,email,_login,true));}case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};export var login=function login(email,password,rememberMe){return/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(dispatch){var response,message;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return authAPI.login(email,password,rememberMe);case 2:response=_context2.sent;if(response.data.resultCode===0){dispatch(getAuthUserData());}else{message=response.data.messages.length>0?response.data.messages[0]:\"some error\";dispatch(stopSubmit(\"login\",{_error:message}));}case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}();};export var logout=function logout(){return/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(dispatch){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return authAPI.logout();case 2:response=_context3.sent;if(response.data.resultCode===0){dispatch(setAuthUserData(null,null,null,false));}case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}();};export default authReducer;","map":{"version":3,"sources":["C:/Users/Дмитрий/Desktop/сайт 4/ReactSocialNetwork/src/redux/auth-reducer.js"],"names":["React","authAPI","stopSubmit","SET_USER_DATA","SET_IS_FETCHING","usersState","userId","email","login","isFetching","isAuth","authReducer","state","action","type","payload","setAuthUserData","getAuthUserData","dispatch","me","response","data","resultCode","id","password","rememberMe","message","messages","length","_error","logout"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport {authAPI} from \"../api/api\";\r\nimport {stopSubmit} from \"redux-form\";\r\n\r\nconst SET_USER_DATA = 'SET_USER_DATA';\r\nconst SET_IS_FETCHING = 'TOGGLE_IS_FETCHING';\r\n\r\nlet usersState = {\r\n    userId: null,\r\n    email: null,\r\n    login: null,\r\n    isFetching: false,\r\n    isAuth: false\r\n};\r\n\r\n\r\nconst authReducer = (state = usersState, action) => {\r\n    switch (action.type) {\r\n        case SET_USER_DATA:\r\n            return {\r\n                ...state,\r\n                ...action.payload\r\n            };\r\n        case SET_IS_FETCHING:\r\n            return {\r\n                ...state,\r\n                isFetching: action.isFetching\r\n            };\r\n\r\n        default:\r\n            return state;\r\n    }\r\n};\r\nexport const setAuthUserData = (userId, email, login, isAuth) => ({\r\n    type: SET_USER_DATA,\r\n    payload: {userId, email, login, isAuth}\r\n});\r\nexport const getAuthUserData = () => async (dispatch) => {\r\n    let response = await authAPI.me();\r\n            if (response.data.resultCode === 0) {\r\n                let {id, email, login} = response.data.data;\r\n                dispatch(setAuthUserData(id, email, login, true));\r\n            }\r\n};\r\n\r\nexport const login = (email, password, rememberMe) => async (dispatch) => {\r\n    let response = await authAPI.login(email, password, rememberMe);\r\n        if (response.data.resultCode === 0) {\r\n            dispatch(getAuthUserData());\r\n        } else {\r\n            let message = response.data.messages.length > 0 ? response.data.messages[0] : \"some error\";\r\n            dispatch(stopSubmit(\"login\", {_error: message}));\r\n        }\r\n};\r\n\r\nexport const logout = () => async (dispatch) => {\r\n    let response = await authAPI.logout();\r\n        if (response.data.resultCode === 0) {\r\n            dispatch(setAuthUserData(null, null, null, false));\r\n        }\r\n};\r\n\r\n\r\nexport default authReducer;"]},"metadata":{},"sourceType":"module"}